{"ast":null,"code":"import React,{useState,useEffect,useCallback,memo}from'react';import{Check,X,User}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CapsuleSharing=/*#__PURE__*/memo(_ref=>{let{onShareSelectionChange}=_ref;const[friends,setFriends]=useState([]);const[selectedFriends,setSelectedFriends]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);// Fetch friends only once when component mounts\nuseEffect(()=>{const fetchFriends=async()=>{try{const response=await fetch('https://istaisprojekts-main-lixsd6.laravel.cloud/api/friends',{headers:{'Authorization':`Bearer ${localStorage.getItem('access_token')}`}});if(!response.ok)throw new Error('Failed to fetch friends');const data=await response.json();const acceptedFriends=data.filter(user=>user.is_friend);setFriends(acceptedFriends);}catch(err){setError('Failed to load friends');console.error(err);}finally{setLoading(false);}};fetchFriends();},[]);// Memoized toggle function\nconst toggleFriendSelection=useCallback(friendId=>{setSelectedFriends(prev=>prev.includes(friendId)?prev.filter(id=>id!==friendId):[...prev,friendId]);},[]);// Notify parent of changes with debounce\nuseEffect(()=>{const timeoutId=setTimeout(()=>{onShareSelectionChange(selectedFriends);},100);return()=>clearTimeout(timeoutId);},[selectedFriends,onShareSelectionChange]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#A3688F]\"})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 text-center p-4\",children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-md mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-left mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-text\",children:\"Share with Friends\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Select friends to share this capsule with\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 max-h-96 overflow-y-auto\",children:friends.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-gray-500 py-8\",children:\"No friends found. Add friends to share your capsule!\"}):friends.map(friend=>/*#__PURE__*/_jsx(FriendItem,{friend:friend,isSelected:selectedFriends.includes(friend.id),onToggle:toggleFriendSelection},friend.id))})]});});// Memoized friend item component\nconst FriendItem=/*#__PURE__*/memo(_ref2=>{let{friend,isSelected,onToggle}=_ref2;return/*#__PURE__*/_jsxs(\"div\",{onClick:()=>onToggle(friend.id),className:`flex items-center p-3 rounded-lg cursor-pointer transition-colors\n      ${isSelected?'bg-[#A3688F] bg-opacity-20':'hover:bg-[#A3688F] hover:bg-opacity-10'}`,children:[friend.profile_image_url?/*#__PURE__*/_jsx(\"img\",{src:friend.profile_image_url,alt:friend.name,className:\"w-10 h-10 rounded-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center\",children:/*#__PURE__*/_jsx(User,{className:\"w-6 h-6 text-gray-400\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-3 flex-grow text-text\",children:friend.name}),isSelected?/*#__PURE__*/_jsx(Check,{className:\"w-5 h-5 text-[#A3688F]\"}):/*#__PURE__*/_jsx(X,{className:\"w-5 h-5 text-gray-300\"})]});});CapsuleSharing.displayName='CapsuleSharing';FriendItem.displayName='FriendItem';export default CapsuleSharing;","map":{"version":3,"names":["React","useState","useEffect","useCallback","memo","Check","X","User","jsx","_jsx","jsxs","_jsxs","CapsuleSharing","_ref","onShareSelectionChange","friends","setFriends","selectedFriends","setSelectedFriends","loading","setLoading","error","setError","fetchFriends","response","fetch","headers","localStorage","getItem","ok","Error","data","json","acceptedFriends","filter","user","is_friend","err","console","toggleFriendSelection","friendId","prev","includes","id","timeoutId","setTimeout","clearTimeout","className","children","length","map","friend","FriendItem","isSelected","onToggle","_ref2","onClick","profile_image_url","src","alt","name","displayName"],"sources":["/Users/kristaps/Desktop/kvalifikacija/react/src/components/capsuleCreationComponents/CapsuleSharing.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, memo } from 'react';\nimport { Check, X, User } from 'lucide-react';\n\nconst CapsuleSharing = memo(({ onShareSelectionChange }) => {\n  const [friends, setFriends] = useState([]);\n  const [selectedFriends, setSelectedFriends] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Fetch friends only once when component mounts\n  useEffect(() => {\n    const fetchFriends = async () => {\n      try {\n        const response = await fetch('https://istaisprojekts-main-lixsd6.laravel.cloud/api/friends', {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('access_token')}`\n          }\n        });\n        if (!response.ok) throw new Error('Failed to fetch friends');\n        const data = await response.json();\n        const acceptedFriends = data.filter(user => user.is_friend);\n        setFriends(acceptedFriends);\n      } catch (err) {\n        setError('Failed to load friends');\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchFriends();\n  }, []);\n\n  // Memoized toggle function\n  const toggleFriendSelection = useCallback((friendId) => {\n    setSelectedFriends(prev => \n      prev.includes(friendId)\n        ? prev.filter(id => id !== friendId)\n        : [...prev, friendId]\n    );\n  }, []);\n\n  // Notify parent of changes with debounce\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      onShareSelectionChange(selectedFriends);\n    }, 100);\n\n    return () => clearTimeout(timeoutId);\n  }, [selectedFriends, onShareSelectionChange]);\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#A3688F]\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-red-500 text-center p-4\">\n        {error}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"w-full max-w-md mx-auto\">\n      <div className=\"text-left mb-4\">\n        <h3 className=\"text-lg font-medium text-text\">Share with Friends</h3>\n        <p className=\"text-sm text-gray-500\">Select friends to share this capsule with</p>\n      </div>\n      <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n        {friends.length === 0 ? (\n          <div className=\"text-center text-gray-500 py-8\">\n            No friends found. Add friends to share your capsule!\n          </div>\n        ) : (\n          friends.map(friend => (\n            <FriendItem\n              key={friend.id}\n              friend={friend}\n              isSelected={selectedFriends.includes(friend.id)}\n              onToggle={toggleFriendSelection}\n            />\n          ))\n        )}\n      </div>\n    </div>\n  );\n});\n\n// Memoized friend item component\nconst FriendItem = memo(({ friend, isSelected, onToggle }) => (\n  <div\n    onClick={() => onToggle(friend.id)}\n    className={`flex items-center p-3 rounded-lg cursor-pointer transition-colors\n      ${isSelected\n        ? 'bg-[#A3688F] bg-opacity-20'\n        : 'hover:bg-[#A3688F] hover:bg-opacity-10'\n      }`}\n  >\n    {friend.profile_image_url ? (\n      <img\n        src={friend.profile_image_url}\n        alt={friend.name}\n        className=\"w-10 h-10 rounded-full object-cover\"\n      />\n    ) : (\n      <div className=\"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center\">\n        <User className=\"w-6 h-6 text-gray-400\" />\n      </div>\n    )}\n    <span className=\"ml-3 flex-grow text-text\">{friend.name}</span>\n    {isSelected ? (\n      <Check className=\"w-5 h-5 text-[#A3688F]\" />\n    ) : (\n      <X className=\"w-5 h-5 text-gray-300\" />\n    )}\n  </div>\n));\n\nCapsuleSharing.displayName = 'CapsuleSharing';\nFriendItem.displayName = 'FriendItem';\n\nexport default CapsuleSharing;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}