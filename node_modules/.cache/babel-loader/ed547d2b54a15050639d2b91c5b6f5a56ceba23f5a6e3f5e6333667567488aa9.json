{"ast":null,"code":"import React,{useState,useCallback,useEffect}from'react';import{BrowserRouter as Router,Routes,Route,useLocation}from'react-router-dom';import DashBoard from'./pages/DashBoard';import Header from'./components/Header';import Login from'./pages/Login';import Register from'./pages/Register';import Profile from'./pages/Profile';import CapsuleCreation from'./pages/CapsuleCreation';import Friends from'./pages/FindFriends';import NotificationSidebar from'./components/NotificationSidebar';import CapsuleAcceptModal from'./components/CapsuleAcceptModal';import Home from'./pages/Home';import{Toaster}from'react-hot-toast';import'slick-carousel/slick/slick.css';import'slick-carousel/slick/slick-theme.css';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const location=useLocation();const currentPath=location.pathname.toLowerCase().replace(/\\/+$/,'');const shouldShowHeader=!['/login','/register','/email-verification'].includes(currentPath);const[isNotificationSidebarOpen,setIsNotificationSidebarOpen]=useState(false);const[notificationCount,setNotificationCount]=useState(0);const[isAcceptModalOpen,setIsAcceptModalOpen]=useState(false);const[selectedCapsule,setSelectedCapsule]=useState(null);const handleCapsuleAccept=useCallback(capsuleData=>{return new Promise((resolve,reject)=>{try{console.log('handleCapsuleAccept called with:',capsuleData);if(!capsuleData||!capsuleData.share_id){reject(new Error('Invalid capsule data'));return;}setSelectedCapsule(capsuleData);setIsAcceptModalOpen(true);resolve();}catch(error){console.error('Error in handleCapsuleAccept:',error);reject(error);}});},[]);const fetchFriendRequestCount=useCallback(async()=>{try{const token=localStorage.getItem('access_token');const response=await fetch('https://istaisprojekts-main-lixsd6.laravel.cloud/api/friends/requests',{headers:{'Authorization':`Bearer ${token}`,'Accept':'application/json'}});const data=await response.json();setNotificationCount(data.length);}catch(error){console.error('Error fetching friend requests:',error);}},[]);useEffect(()=>{console.log('Modal state changed:',{isAcceptModalOpen,selectedCapsule});},[isAcceptModalOpen,selectedCapsule]);// Create a single instance of NotificationSidebar component\nconst notificationSidebar=/*#__PURE__*/_jsx(NotificationSidebar,{isOpen:isNotificationSidebarOpen,onClose:()=>setIsNotificationSidebarOpen(false),onUpdateCount:setNotificationCount,onCapsuleAccept:handleCapsuleAccept,fetchFriendRequestCount:fetchFriendRequestCount});// Create a single instance of CapsuleAcceptModal component\nconst capsuleAcceptModal=isAcceptModalOpen&&selectedCapsule&&/*#__PURE__*/_jsx(CapsuleAcceptModal,{isOpen:isAcceptModalOpen,onClose:()=>{console.log('Modal closing');setIsAcceptModalOpen(false);setSelectedCapsule(null);},capsule:selectedCapsule,onAcceptComplete:()=>{console.log('Accept complete');setIsAcceptModalOpen(false);setSelectedCapsule(null);}});return/*#__PURE__*/_jsxs(\"div\",{className:\"relative min-h-screen\",children:[/*#__PURE__*/_jsx(Toaster,{position:\"top-right\"}),shouldShowHeader&&/*#__PURE__*/_jsx(Header,{notificationCount:notificationCount,onNotificationClick:()=>setIsNotificationSidebarOpen(true)}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(DashBoard,{}),notificationSidebar,capsuleAcceptModal]})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/home\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(Register,{})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Profile,{}),notificationSidebar,capsuleAcceptModal]})}),/*#__PURE__*/_jsx(Route,{path:\"/CapsuleCreation\",element:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CapsuleCreation,{}),notificationSidebar,capsuleAcceptModal]})}),/*#__PURE__*/_jsx(Route,{path:\"/friends\",element:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Friends,{}),notificationSidebar,capsuleAcceptModal]})})]})]});}export default function AppWrapper(){return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(App,{})});}","map":{"version":3,"names":["React","useState","useCallback","useEffect","BrowserRouter","Router","Routes","Route","useLocation","DashBoard","Header","Login","Register","Profile","CapsuleCreation","Friends","NotificationSidebar","CapsuleAcceptModal","Home","Toaster","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","App","location","currentPath","pathname","toLowerCase","replace","shouldShowHeader","includes","isNotificationSidebarOpen","setIsNotificationSidebarOpen","notificationCount","setNotificationCount","isAcceptModalOpen","setIsAcceptModalOpen","selectedCapsule","setSelectedCapsule","handleCapsuleAccept","capsuleData","Promise","resolve","reject","console","log","share_id","Error","error","fetchFriendRequestCount","token","localStorage","getItem","response","fetch","headers","data","json","length","notificationSidebar","isOpen","onClose","onUpdateCount","onCapsuleAccept","capsuleAcceptModal","capsule","onAcceptComplete","className","children","position","onNotificationClick","path","element","AppWrapper"],"sources":["/Users/kristaps/Desktop/kvalifikacija/react/src/App.js"],"sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, useLocation } from 'react-router-dom';\nimport DashBoard from './pages/DashBoard';\nimport Header from './components/Header';\nimport Login from './pages/Login';\nimport Register from './pages/Register';\nimport Profile from './pages/Profile';\nimport CapsuleCreation from './pages/CapsuleCreation';\nimport Friends from './pages/FindFriends';\nimport NotificationSidebar from './components/NotificationSidebar';\nimport CapsuleAcceptModal from './components/CapsuleAcceptModal';\nimport Home from './pages/Home';\nimport { Toaster } from 'react-hot-toast';\nimport 'slick-carousel/slick/slick.css';\nimport 'slick-carousel/slick/slick-theme.css';\n\nfunction App() {\n  const location = useLocation();\n  const currentPath = location.pathname.toLowerCase().replace(/\\/+$/, '');\n  const shouldShowHeader = !['/login', '/register', '/email-verification'].includes(currentPath);\n\n  const [isNotificationSidebarOpen, setIsNotificationSidebarOpen] = useState(false);\n  const [notificationCount, setNotificationCount] = useState(0);\n  const [isAcceptModalOpen, setIsAcceptModalOpen] = useState(false);\n  const [selectedCapsule, setSelectedCapsule] = useState(null);\n\n  const handleCapsuleAccept = useCallback((capsuleData) => {\n    return new Promise((resolve, reject) => {\n      try {\n        console.log('handleCapsuleAccept called with:', capsuleData);\n        if (!capsuleData || !capsuleData.share_id) {\n          reject(new Error('Invalid capsule data'));\n          return;\n        }\n        setSelectedCapsule(capsuleData);\n        setIsAcceptModalOpen(true);\n        resolve();\n      } catch (error) {\n        console.error('Error in handleCapsuleAccept:', error);\n        reject(error);\n      }\n    });\n  }, []);\n\n  const fetchFriendRequestCount = useCallback(async () => {\n    try {\n      const token = localStorage.getItem('access_token');\n      const response = await fetch('https://istaisprojekts-main-lixsd6.laravel.cloud/api/friends/requests', {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Accept': 'application/json',\n        },\n      });\n      const data = await response.json();\n      setNotificationCount(data.length);\n    } catch (error) {\n      console.error('Error fetching friend requests:', error);\n    }\n  }, []);\n\n  useEffect(() => {\n    console.log('Modal state changed:', { isAcceptModalOpen, selectedCapsule });\n  }, [isAcceptModalOpen, selectedCapsule]);\n\n  // Create a single instance of NotificationSidebar component\n  const notificationSidebar = (\n      <NotificationSidebar\n          isOpen={isNotificationSidebarOpen}\n          onClose={() => setIsNotificationSidebarOpen(false)}\n          onUpdateCount={setNotificationCount}\n          onCapsuleAccept={handleCapsuleAccept}\n          fetchFriendRequestCount={fetchFriendRequestCount}\n      />\n  );\n\n  // Create a single instance of CapsuleAcceptModal component\n  const capsuleAcceptModal = isAcceptModalOpen && selectedCapsule && (\n      <CapsuleAcceptModal\n          isOpen={isAcceptModalOpen}\n          onClose={() => {\n            console.log('Modal closing');\n            setIsAcceptModalOpen(false);\n            setSelectedCapsule(null);\n          }}\n          capsule={selectedCapsule}\n          onAcceptComplete={() => {\n            console.log('Accept complete');\n            setIsAcceptModalOpen(false);\n            setSelectedCapsule(null);\n          }}\n      />\n  );\n\n  return (\n      <div className=\"relative min-h-screen\">\n        <Toaster position=\"top-right\" />\n        {shouldShowHeader && (\n            <Header\n                notificationCount={notificationCount}\n                onNotificationClick={() => setIsNotificationSidebarOpen(true)}\n            />\n        )}\n\n        <Routes>\n          <Route path=\"/dashboard\" element={\n            <>\n              <DashBoard />\n              {notificationSidebar}\n              {capsuleAcceptModal}\n            </>\n          } />\n          <Route path=\"/login\" element={<Login />} />\n          <Route path=\"/home\" element={<Home />} />\n          <Route path=\"/register\" element={<Register />} />\n          <Route path=\"/profile\" element={\n            <>\n              <Profile />\n              {notificationSidebar}\n              {capsuleAcceptModal}\n            </>\n          } />\n          <Route path=\"/CapsuleCreation\" element={\n            <>\n              <CapsuleCreation />\n              {notificationSidebar}\n              {capsuleAcceptModal}\n            </>\n          } />\n          <Route path=\"/friends\" element={\n            <>\n              <Friends />\n              {notificationSidebar}\n              {capsuleAcceptModal}\n            </>\n          } />\n        </Routes>\n      </div>\n  );\n}\n\nexport default function AppWrapper() {\n  return (\n      <Router>\n        <App />\n      </Router>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}