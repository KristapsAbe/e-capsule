{"ast":null,"code":"import React,{useState,useEffect,useCallback,useMemo,memo,Suspense}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{toast}from'react-hot-toast';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faSearch,faUserPlus,faTimes,faCheck,faUserFriends,faClock,faUsers,faLock,faGlobe,faUserGroup,faChevronLeft,faChevronRight,faCapsules}from'@fortawesome/free-solid-svg-icons';import{Lock,Unlock,Star,BookOpen,Clock,Shield,Heart,Quote,MessageCircle,Camera,Package}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ImageWithFallback=/*#__PURE__*/memo(_ref=>{let{src,alt,onLoad,onError,className}=_ref;const[imgSrc,setImgSrc]=useState(src);const handleError=()=>{setImgSrc('/images/DefaultAvatar.jpg');onError===null||onError===void 0?void 0:onError();};return/*#__PURE__*/_jsx(\"img\",{src:imgSrc,alt:alt,className:className,onError:handleError,onLoad:onLoad,loading:\"lazy\",decoding:\"async\",width:\"128\",height:\"128\"});});const UserModal=/*#__PURE__*/memo(_ref2=>{let{user,onClose,onSendRequest,isPending}=_ref2;const[userCapsules,setUserCapsules]=useState([]);const[capsuleLoading,setCapsuleLoading]=useState(true);const[error,setError]=useState(null);const[isFriend,setIsFriend]=useState(false);useEffect(()=>{const fetchCapsules=async()=>{try{setCapsuleLoading(true);setError(null);const token=localStorage.getItem('access_token');if(!token){throw new Error('No access token found');}const url=`https://istaisprojekts-main-lixsd6.laravel.cloud/api/friends/${user.id}/capsules`;console.log('Fetching capsules from:',url);const response=await axios.get(url,{headers:{Authorization:`Bearer ${token}`}});console.log('Response:',response);if(response.data.status==='success'){console.log('Capsules data:',response.data.data);let capsuleArray=response.data.data;if(!Array.isArray(capsuleArray)&&typeof capsuleArray==='object'){capsuleArray=Object.values(capsuleArray);}const enhancedCapsules=capsuleArray.map(capsule=>{const createdDate=new Date(capsule.created_at);const now=new Date();const daysSinceCreation=Math.floor((now-createdDate)/(1000*60*60*24));const mockOpeningDays=30;// Assuming capsules open after 30 days\nconst daysLeft=Math.max(0,mockOpeningDays-daysSinceCreation);const designs=['heritage','chronicle','legacy','vault'];const design=capsule.design||designs[Math.floor(Math.random()*designs.length)];return{...capsule,daysLeft,design};});setUserCapsules(enhancedCapsules);const hasFriendOnlyCapsules=capsuleArray.some(capsule=>capsule.privacy==='friends');setIsFriend(hasFriendOnlyCapsules);}else{console.error('Failed to fetch capsules:',response.data);setError('Failed to fetch capsules');}}catch(err){var _err$response,_err$response2,_err$response2$data;console.error('Error fetching capsules:',err);console.error('Response data:',(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data);setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||err.message);}finally{setCapsuleLoading(false);}};if(user){fetchCapsules();}},[user]);const getDesignStyles=design=>{const styles={heritage:{container:'bg-gradient-to-br from-[#382330] to-[#5E3762] border-[#B2779F] text-[#E5E6F0]',header:'text-[#E5E6F0] bg-black/40',accent:'#FFD700',// Gold\nsecondaryColor:'#B2779F',contentBg:'bg-black/30 border-[#B2779F]/50',filter:'brightness-95 contrast-110',icon:/*#__PURE__*/_jsx(Star,{className:\"text-[#FFD700]\",size:18}),pattern:'bg-[url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCI+PHBhdGggZD0iTTEwLDEwIEwzMCwxMCBMMzAsMzAgTDEwLDMwIFoiIHN0cm9rZT0iI0ZGRDcwMDIwIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiLz48L3N2Zz4=\")]',boxShadow:'0 10px 25px -5px rgba(178, 119, 159, 0.4)'},chronicle:{container:'bg-gradient-to-r from-[#0D0E16] to-[#193A5A] border-[#64DFDF] text-[#E5E6F0]',header:'text-[#E5E6F0] bg-black/40',accent:'#64DFDF',// Cyan\nsecondaryColor:'#A7ACCD',contentBg:'bg-black/30 border-[#64DFDF]/50',filter:'brightness-95 saturate-105',icon:/*#__PURE__*/_jsx(BookOpen,{className:\"text-[#64DFDF]\",size:18}),pattern:'bg-[url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCI+PHJlY3Qgd2lkdGg9IjIiIGhlaWdodD0iMiIgeD0iMjkiIHk9IjI5IiBmaWxsPSIjNjRERkRGMzAiLz48L3N2Zz4=\")]',boxShadow:'0 0 30px -5px rgba(100, 223, 223, 0.5)'},legacy:{container:'bg-gradient-to-br from-[#3D2C40] to-[#5E3762] border-[#FF95DD] text-[#E5E6F0]',header:'text-[#E5E6F0] bg-black/40',accent:'#FF95DD',// Pink\nsecondaryColor:'#FF95DD',contentBg:'bg-black/30 border-[#FF95DD]/50',filter:'brightness-100 contrast-110',icon:/*#__PURE__*/_jsx(Heart,{className:\"text-[#FF95DD]\",size:18}),pattern:'bg-[url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIj48cGF0aCBkPSJNMjUsMjUgQzI1LDUwIDc1LDUwIDc1LDI1IiBzdHJva2U9IiNGRjk1REQyMCIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTI1LDc1IEMyNSw1MCA3NSw1MCA3NSw3NSIgc3Ryb2tlPSIjRkY5NUREMjAiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==\")]',boxShadow:'0 10px 25px -5px rgba(255, 149, 221, 0.3)'},vault:{container:'bg-gradient-to-r from-[#1A3A4A] to-[#30637C] border-[#A3E4DB] text-[#E5E6F0]',header:'text-[#E5E6F0] bg-black/40',accent:'#A3E4DB',// Teal\nsecondaryColor:'#A3688F',contentBg:'bg-black/30 border-[#A3E4DB]/50',filter:'brightness-95 contrast-110',icon:/*#__PURE__*/_jsx(Shield,{className:\"text-[#A3E4DB]\",size:18}),pattern:'bg-[url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCI+PHBhdGggZD0iTTMwLDEwIEwxMCwzMCBMMzAsNTAgTDUwLDMwIFoiIHN0cm9rZT0iI0EzRTREQjIwIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiLz48L3N2Zz4=\")]',boxShadow:'0 10px 25px -5px rgba(163, 228, 219, 0.3)'}};return styles[design]||styles.heritage;};const getDesignIcon=design=>{const iconMap={'heritage':/*#__PURE__*/_jsx(Star,{className:\"text-[#FFD700]\",size:18}),'chronicle':/*#__PURE__*/_jsx(BookOpen,{className:\"text-[#64DFDF]\",size:18}),'legacy':/*#__PURE__*/_jsx(Heart,{className:\"text-[#FF95DD]\",size:18}),'vault':/*#__PURE__*/_jsx(Shield,{className:\"text-[#A3E4DB]\",size:18})};return iconMap[design]||iconMap.heritage;};const getPrivacyIcon=privacy=>{switch(privacy){case'private':return faLock;case'friends':return faUserGroup;case'public':return faGlobe;default:return faGlobe;}};const ThemeDecoration=_ref3=>{let{design}=_ref3;const styles=getDesignStyles(design);return/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 pointer-events-none overflow-hidden rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:`absolute inset-0 ${styles.pattern} opacity-30`}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent opacity-30 animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-white/40 to-transparent\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-y-0 right-0 w-px bg-gradient-to-b from-transparent via-white/30 to-transparent\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-x-0 bottom-0 h-px bg-gradient-to-r from-transparent via-white/40 to-transparent\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-y-0 left-0 w-px bg-gradient-to-b from-transparent via-white/30 to-transparent\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent\"})]});};const CapsuleCard=_ref4=>{let{capsule}=_ref4;const design=capsule.design||'heritage';const styles=getDesignStyles(design);const isReady=capsule.daysLeft<=0;const images=JSON.parse(capsule.images||'[]');const hasImages=images.length>0;return/*#__PURE__*/_jsxs(\"div\",{className:`relative rounded-lg border overflow-hidden mb-3 ${styles.contentBg}`,children:[/*#__PURE__*/_jsx(ThemeDecoration,{design:design}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center p-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[getDesignIcon(design),/*#__PURE__*/_jsx(\"p\",{className:\"text-text font-medium truncate\",children:capsule.title})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:getPrivacyIcon(capsule.privacy),className:\"text-text/50\",title:`Privacy: ${capsule.privacy}`}),isReady?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-xs px-2 py-1 rounded-full bg-white/10 backdrop-blur-sm\",children:[/*#__PURE__*/_jsx(Unlock,{size:12,style:{color:styles.accent},className:\"mr-1\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:styles.accent},children:\"Ready\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-xs px-2 py-1 rounded-full bg-black/30\",children:[/*#__PURE__*/_jsx(Lock,{size:12,style:{color:styles.accent},className:\"mr-1\"}),/*#__PURE__*/_jsx(\"span\",{children:`${capsule.daysLeft}d`})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 rounded overflow-hidden mr-3 relative bg-black/40\",children:hasImages?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{src:\"/api/placeholder/64/64\",alt:\"Memory preview\",className:`w-full h-full object-cover blur-sm ${styles.filter}`}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Camera,{size:16,style:{color:styles.accent}})})]}):/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Package,{size:16,style:{color:styles.accent}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-text/60 text-xs line-clamp-2\",children:capsule.description||\"This memory is sealed until it's time to open it.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 flex items-center text-text/50 text-xs\",children:[/*#__PURE__*/_jsx(Clock,{size:10,className:\"mr-1\"}),/*#__PURE__*/_jsx(\"span\",{children:new Date(capsule.created_at).toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'})})]})]})]})]});};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-background rounded-2xl max-w-md w-full overflow-hidden shadow-2xl border border-white/10\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-br from-[#3D2C40] to-[#5E3762]\",children:/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIj48cGF0aCBkPSJNMjUsMjUgQzI1LDUwIDc1LDUwIDc1LDI1IiBzdHJva2U9IiNGRjk1REQyMCIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTI1LDc1IEMyNSw1MCA3NSw1MCA3NSw3NSIgc3Ryb2tlPSIjRkY5NUREMjAiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==')]\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"relative p-6 backdrop-blur-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(ImageWithFallback,{src:user.profile_image_url,alt:user.name,className:\"w-20 h-20 rounded-full object-cover border-4 border-[#FF95DD]\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 rounded-full shadow-inner\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-white font-lexend font-bold text-2xl\",children:user.name}),!isFriend&&/*#__PURE__*/_jsx(\"div\",{className:\"text-white/70 mt-2 text-sm\",children:isPending?/*#__PURE__*/_jsxs(\"p\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUserGroup,className:\"opacity-70 mr-2\"}),\"Friend request pending\"]}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Not friends yet\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onSendRequest,className:\"ml-2 px-3 py-1 bg-[#FF95DD] text-white rounded-lg text-xs hover:bg-[#FF95DD]/90 transition\",children:\"Add Friend\"})]})})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-white/50 hover:text-white transition-colors\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faTimes,size:\"lg\"})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 max-h-96 overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-4\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCapsules,className:\"text-[#FF95DD] mr-2\"}),/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-medium text-text/90\",children:[\"Memories \",userCapsules.length>0?`(${userCapsules.length})`:'']}),!isFriend&&userCapsules.length>0&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-xs text-text/50\",children:\"(showing public only)\"})]}),capsuleLoading?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4 mt-4\",children:[1,2,3].map(i=>/*#__PURE__*/_jsx(\"div\",{className:\"h-24 bg-white/5 rounded-lg animate-pulse\"},i))}):error?/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 text-sm bg-red-500/10 p-4 rounded-lg\",children:error}):userCapsules.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:userCapsules.map(capsule=>/*#__PURE__*/_jsx(CapsuleCard,{capsule:capsule},capsule.id))}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-text/70\",children:[/*#__PURE__*/_jsx(Package,{size:32,className:\"mx-auto mb-4 text-[#FF95DD] opacity-50\"}),isFriend?'No memories created yet':'No public memories available']})]})]})});});const UserCard=/*#__PURE__*/memo(_ref5=>{let{user,onSelect,onSendRequest,isPending}=_ref5;const handleClick=useCallback(()=>{onSelect(user);},[user,onSelect]);const handleSendRequest=useCallback(e=>{e.stopPropagation();if(!isPending&&!user.friend_request_sent&&!user.is_friend){onSendRequest(user.id);}},[user,isPending,onSendRequest]);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-background/70 rounded-2xl p-4 sm:p-6 flex flex-col items-center shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer\",onClick:handleClick,children:[/*#__PURE__*/_jsx(\"div\",{className:\"relative w-20 h-20 sm:w-32 sm:h-32 mb-4\",children:/*#__PURE__*/_jsx(ImageWithFallback,{src:user.profile_image_url,alt:user.name,className:\"w-full h-full rounded-full object-cover border-4 border-[#FF95DD]\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-text font-lexend font-bold text-lg sm:text-xl mb-2\",children:user.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-text/70 font-lexend text-xs sm:text-sm mb-4 line-clamp-2\",children:user.bio||'No bio available'}),user.is_friend?/*#__PURE__*/_jsxs(\"span\",{className:\"text-[#FF95DD] font-medium flex items-center gap-2\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUserFriends}),\"Already Friends\"]}):user.friend_request_sent?/*#__PURE__*/_jsxs(\"span\",{className:\"text-[#FF95DD] font-medium flex items-center gap-2\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCheck}),\"Request Sent\"]}):/*#__PURE__*/_jsx(\"button\",{className:`bg-gradient-to-r from-[#FF95DD] to-[#FF5CAA] text-background font-lexend font-medium py-2 px-4 sm:px-6 rounded-full flex items-center hover:opacity-90 transition-opacity ${isPending?'opacity-50 cursor-not-allowed':''}`,onClick:handleSendRequest,disabled:isPending,children:isPending?/*#__PURE__*/_jsx(\"span\",{children:\"Sending...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUserPlus,className:\"mr-2\"}),\"Connect\"]})})]});});const SearchInput=/*#__PURE__*/memo(_ref6=>{let{value,onChange}=_ref6;return/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-full max-w-sm mb-6 sm:mb-12\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search users...\",className:\"w-full py-2 sm:py-3 px-4 sm:px-6 pr-10 rounded-full border-2 border-[#FF95DD] bg-background/50 text-text focus:outline-none focus:border-[#FF5CAA] transition-all duration-300\",value:value,onChange:onChange}),/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faSearch,className:\"absolute right-4 top-1/2 transform -translate-y-1/2 text-[#FF95DD]\"})]});});const Pagination=/*#__PURE__*/memo(_ref7=>{let{currentPage,totalPages,onPageChange}=_ref7;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center gap-4 mt-8\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>onPageChange(currentPage-1),disabled:currentPage===1,className:`p-2 rounded-full ${currentPage===1?'text-text/30 cursor-not-allowed':'text-[#FF95DD] hover:bg-[#FF95DD]/10'}`,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faChevronLeft})}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-lexend text-text\",children:[\"Page \",currentPage,\" of \",totalPages]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onPageChange(currentPage+1),disabled:currentPage===totalPages,className:`p-2 rounded-full ${currentPage===totalPages?'text-text/30 cursor-not-allowed':'text-[#FF95DD] hover:bg-[#FF95DD]/10'}`,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faChevronRight})})]});});const FriendsPage=()=>{const[allUsers,setAllUsers]=useState([]);// Store all users\nconst[users,setUsers]=useState([]);const[searchTerm,setSearchTerm]=useState('');const[selectedUser,setSelectedUser]=useState(null);const[isInitialLoading,setIsInitialLoading]=useState(true);const[pendingRequests,setPendingRequests]=useState(new Set());const[error,setError]=useState(null);const[currentPage,setCurrentPage]=useState(1);const[totalPages,setTotalPages]=useState(1);const[totalUsers,setTotalUsers]=useState(0);const navigate=useNavigate();const USERS_PER_PAGE=9;useEffect(()=>{const controller=new AbortController();const fetchUsers=async()=>{const token=localStorage.getItem('access_token');if(!token){navigate('/login');return;}try{const response=await fetch(`https://istaisprojekts-main-lixsd6.laravel.cloud/api/friends`,{headers:{'Authorization':`Bearer ${token}`,'Accept':'application/json'},signal:controller.signal});if(!response.ok){const errorData=await response.json();throw new Error(errorData.message||'Failed to fetch users');}const data=await response.json();if(Array.isArray(data)){setAllUsers(data);setTotalUsers(data.length);}else if(data.users&&Array.isArray(data.users)){setAllUsers(data.users);setTotalUsers(data.total||data.users.length);}else{setAllUsers([]);setTotalUsers(0);console.error('Unexpected API response structure:',data);}setError(null);}catch(error){if(error.name!=='AbortError'){console.error('Error fetching users:',error);setError(error.message);toast.error('Failed to load users: '+error.message);setAllUsers([]);setTotalUsers(0);}}finally{setIsInitialLoading(false);}};fetchUsers();return()=>controller.abort();},[navigate]);useEffect(()=>{if(!Array.isArray(allUsers))return;const searchLower=searchTerm.toLowerCase();const filtered=searchTerm?allUsers.filter(user=>user.name.toLowerCase().includes(searchLower)):allUsers;setTotalUsers(filtered.length);setTotalPages(Math.ceil(filtered.length/USERS_PER_PAGE));const startIndex=(currentPage-1)*USERS_PER_PAGE;const endIndex=startIndex+USERS_PER_PAGE;setUsers(filtered.slice(startIndex,endIndex));if(currentPage>Math.ceil(filtered.length/USERS_PER_PAGE)){setCurrentPage(1);}},[allUsers,searchTerm,currentPage,USERS_PER_PAGE]);const filteredUsers=useMemo(()=>{const filledArray=[...users];while(filledArray.length<USERS_PER_PAGE){filledArray.push(null);}return filledArray;},[users]);const handleSearch=useCallback(e=>{setSearchTerm(e.target.value);setCurrentPage(1);},[]);const handlePageChange=useCallback(newPage=>{setCurrentPage(newPage);},[]);const handleSendRequest=useCallback(async targetUserId=>{setPendingRequests(prev=>new Set(prev).add(targetUserId));const token=localStorage.getItem('access_token');if(!token){navigate('/login');return;}try{const response=await fetch('https://istaisprojekts-main-lixsd6.laravel.cloud/api/friends/request',{method:'POST',headers:{'Authorization':`Bearer ${token}`,'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({target_user_id:targetUserId})});if(!response.ok)throw new Error('Failed to send friend request');toast.success('Friend request sent');setAllUsers(prev=>prev.map(user=>(user===null||user===void 0?void 0:user.id)===targetUserId?{...user,friend_request_sent:true}:user));setUsers(prev=>prev.map(user=>(user===null||user===void 0?void 0:user.id)===targetUserId?{...user,friend_request_sent:true}:user));}catch(error){console.error('Error sending friend request:',error);toast.error('Failed to send friend request');}finally{setPendingRequests(prev=>{const newSet=new Set(prev);newSet.delete(targetUserId);return newSet;});}},[navigate]);const handleUserSelect=useCallback(user=>{if(user)setSelectedUser(user);},[]);const handleCloseModal=useCallback(()=>{setSelectedUser(null);},[]);const EmptyCard=/*#__PURE__*/memo(()=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-background/70 rounded-2xl p-4 sm:p-6 flex flex-col items-center shadow-lg h-full\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 sm:w-32 sm:h-32 mb-4 bg-gray-200 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-6 w-32 bg-gray-200 rounded mb-2 animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-4 w-48 bg-gray-200 rounded mb-4 animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-8 w-24 bg-gray-200 rounded-full animate-pulse\"})]}));return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen flex flex-col items-center bg-background px-4 sm:px-8 py-12\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-text font-lexend font-bold text-2xl sm:text-4xl mb-6 sm:mb-12\",children:\"Find Friends\"}),/*#__PURE__*/_jsx(SearchInput,{value:searchTerm,onChange:handleSearch}),/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),children:isInitialLoading?/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 w-full\",children:Array(USERS_PER_PAGE).fill(null).map((_,index)=>/*#__PURE__*/_jsx(EmptyCard,{},`loading-${index}`))}):error?/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:error}):totalUsers===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-text/70\",children:\"No users found\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 w-full\",children:filteredUsers.map((user,index)=>user?/*#__PURE__*/_jsx(UserCard,{user:user,onSelect:handleUserSelect,onSendRequest:handleSendRequest,isPending:pendingRequests.has(user.id)},user.id):/*#__PURE__*/_jsx(EmptyCard,{},`empty-${index}`))}),totalPages>1&&/*#__PURE__*/_jsx(Pagination,{currentPage:currentPage,totalPages:totalPages,onPageChange:handlePageChange})]})}),selectedUser&&/*#__PURE__*/_jsx(UserModal,{user:selectedUser,onClose:handleCloseModal,onSendRequest:handleSendRequest,isPending:pendingRequests.has(selectedUser.id)})]});};export default FriendsPage;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","memo","Suspense","axios","useNavigate","toast","FontAwesomeIcon","faSearch","faUserPlus","faTimes","faCheck","faUserFriends","faClock","faUsers","faLock","faGlobe","faUserGroup","faChevronLeft","faChevronRight","faCapsules","Lock","Unlock","Star","BookOpen","Clock","Shield","Heart","Quote","MessageCircle","Camera","Package","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ImageWithFallback","_ref","src","alt","onLoad","onError","className","imgSrc","setImgSrc","handleError","loading","decoding","width","height","UserModal","_ref2","user","onClose","onSendRequest","isPending","userCapsules","setUserCapsules","capsuleLoading","setCapsuleLoading","error","setError","isFriend","setIsFriend","fetchCapsules","token","localStorage","getItem","Error","url","id","console","log","response","get","headers","Authorization","data","status","capsuleArray","Array","isArray","Object","values","enhancedCapsules","map","capsule","createdDate","Date","created_at","now","daysSinceCreation","Math","floor","mockOpeningDays","daysLeft","max","designs","design","random","length","hasFriendOnlyCapsules","some","privacy","err","_err$response","_err$response2","_err$response2$data","message","getDesignStyles","styles","heritage","container","header","accent","secondaryColor","contentBg","filter","icon","size","pattern","boxShadow","chronicle","legacy","vault","getDesignIcon","iconMap","getPrivacyIcon","ThemeDecoration","_ref3","children","CapsuleCard","_ref4","isReady","images","JSON","parse","hasImages","title","style","color","description","toLocaleDateString","undefined","year","month","day","onClick","e","stopPropagation","profile_image_url","name","i","UserCard","_ref5","onSelect","handleClick","handleSendRequest","friend_request_sent","is_friend","bio","disabled","SearchInput","_ref6","value","onChange","type","placeholder","Pagination","_ref7","currentPage","totalPages","onPageChange","FriendsPage","allUsers","setAllUsers","users","setUsers","searchTerm","setSearchTerm","selectedUser","setSelectedUser","isInitialLoading","setIsInitialLoading","pendingRequests","setPendingRequests","Set","setCurrentPage","setTotalPages","totalUsers","setTotalUsers","navigate","USERS_PER_PAGE","controller","AbortController","fetchUsers","fetch","signal","ok","errorData","json","total","abort","searchLower","toLowerCase","filtered","includes","ceil","startIndex","endIndex","slice","filteredUsers","filledArray","push","handleSearch","target","handlePageChange","newPage","targetUserId","prev","add","method","body","stringify","target_user_id","success","newSet","delete","handleUserSelect","handleCloseModal","EmptyCard","fallback","fill","_","index","has"],"sources":["/Users/kristaps/Desktop/kvalifikacija/react/src/pages/FindFriends.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo, memo, Suspense } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-hot-toast';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faSearch,\n  faUserPlus,\n  faTimes,\n  faCheck,\n  faUserFriends,\n  faClock,\n  faUsers,\n  faLock,\n  faGlobe,\n  faUserGroup,\n  faChevronLeft,\n  faChevronRight,\n  faCapsules\n} from '@fortawesome/free-solid-svg-icons';\nimport { Lock, Unlock, Star, BookOpen, Clock, Shield, Heart, Quote, MessageCircle, Camera, Package } from 'lucide-react';\n\nconst ImageWithFallback = memo(({ src, alt, onLoad, onError, className }) => {\n  const [imgSrc, setImgSrc] = useState(src);\n\n  const handleError = () => {\n    setImgSrc('/images/DefaultAvatar.jpg');\n    onError?.();\n  };\n\n  return (\n    <img\n      src={imgSrc}\n      alt={alt}\n      className={className}\n      onError={handleError}\n      onLoad={onLoad}\n      loading=\"lazy\"\n      decoding=\"async\"\n      width=\"128\"\n      height=\"128\"\n    />\n  );\n});\n\nconst UserModal = memo(({ user, onClose, onSendRequest, isPending }) => {\n  const [userCapsules, setUserCapsules] = useState([]);\n  const [capsuleLoading, setCapsuleLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [isFriend, setIsFriend] = useState(false);\n\n  useEffect(() => {\n    const fetchCapsules = async () => {\n      try {\n        setCapsuleLoading(true);\n        setError(null);\n\n        const token = localStorage.getItem('access_token');\n        if (!token) {\n          throw new Error('No access token found');\n        }\n\n        const url = `https://istaisprojekts-main-lixsd6.laravel.cloud/api/friends/${user.id}/capsules`;\n        console.log('Fetching capsules from:', url);\n\n        const response = await axios.get(url, {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        });\n\n        console.log('Response:', response);\n\n        if (response.data.status === 'success') {\n          console.log('Capsules data:', response.data.data);\n\n          let capsuleArray = response.data.data;\n          if (!Array.isArray(capsuleArray) && typeof capsuleArray === 'object') {\n            capsuleArray = Object.values(capsuleArray);\n          }\n\n          const enhancedCapsules = capsuleArray.map(capsule => {\n            const createdDate = new Date(capsule.created_at);\n            const now = new Date();\n            const daysSinceCreation = Math.floor((now - createdDate) / (1000 * 60 * 60 * 24));\n            const mockOpeningDays = 30; // Assuming capsules open after 30 days\n            const daysLeft = Math.max(0, mockOpeningDays - daysSinceCreation);\n\n            const designs = ['heritage', 'chronicle', 'legacy', 'vault'];\n            const design = capsule.design || designs[Math.floor(Math.random() * designs.length)];\n\n            return {\n              ...capsule,\n              daysLeft,\n              design\n            };\n          });\n\n          setUserCapsules(enhancedCapsules);\n\n          const hasFriendOnlyCapsules = capsuleArray.some(\n              capsule => capsule.privacy === 'friends'\n          );\n          setIsFriend(hasFriendOnlyCapsules);\n        } else {\n          console.error('Failed to fetch capsules:', response.data);\n          setError('Failed to fetch capsules');\n        }\n      } catch (err) {\n        console.error('Error fetching capsules:', err);\n        console.error('Response data:', err.response?.data);\n        setError(err.response?.data?.message || err.message);\n      } finally {\n        setCapsuleLoading(false);\n      }\n    };\n\n    if (user) {\n      fetchCapsules();\n    }\n  }, [user]);\n\n  const getDesignStyles = (design) => {\n    const styles = {\n      heritage: {\n        container: 'bg-gradient-to-br from-[#382330] to-[#5E3762] border-[#B2779F] text-[#E5E6F0]',\n        header: 'text-[#E5E6F0] bg-black/40',\n        accent: '#FFD700', // Gold\n        secondaryColor: '#B2779F',\n        contentBg: 'bg-black/30 border-[#B2779F]/50',\n        filter: 'brightness-95 contrast-110',\n        icon: <Star className=\"text-[#FFD700]\" size={18} />,\n        pattern: 'bg-[url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCI+PHBhdGggZD0iTTEwLDEwIEwzMCwxMCBMMzAsMzAgTDEwLDMwIFoiIHN0cm9rZT0iI0ZGRDcwMDIwIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiLz48L3N2Zz4=\")]',\n        boxShadow: '0 10px 25px -5px rgba(178, 119, 159, 0.4)',\n      },\n      chronicle: {\n        container: 'bg-gradient-to-r from-[#0D0E16] to-[#193A5A] border-[#64DFDF] text-[#E5E6F0]',\n        header: 'text-[#E5E6F0] bg-black/40',\n        accent: '#64DFDF', // Cyan\n        secondaryColor: '#A7ACCD',\n        contentBg: 'bg-black/30 border-[#64DFDF]/50',\n        filter: 'brightness-95 saturate-105',\n        icon: <BookOpen className=\"text-[#64DFDF]\" size={18} />,\n        pattern: 'bg-[url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCI+PHJlY3Qgd2lkdGg9IjIiIGhlaWdodD0iMiIgeD0iMjkiIHk9IjI5IiBmaWxsPSIjNjRERkRGMzAiLz48L3N2Zz4=\")]',\n        boxShadow: '0 0 30px -5px rgba(100, 223, 223, 0.5)',\n      },\n      legacy: {\n        container: 'bg-gradient-to-br from-[#3D2C40] to-[#5E3762] border-[#FF95DD] text-[#E5E6F0]',\n        header: 'text-[#E5E6F0] bg-black/40',\n        accent: '#FF95DD', // Pink\n        secondaryColor: '#FF95DD',\n        contentBg: 'bg-black/30 border-[#FF95DD]/50',\n        filter: 'brightness-100 contrast-110',\n        icon: <Heart className=\"text-[#FF95DD]\" size={18} />,\n        pattern: 'bg-[url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIj48cGF0aCBkPSJNMjUsMjUgQzI1LDUwIDc1LDUwIDc1LDI1IiBzdHJva2U9IiNGRjk1REQyMCIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTI1LDc1IEMyNSw1MCA3NSw1MCA3NSw3NSIgc3Ryb2tlPSIjRkY5NUREMjAiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==\")]',\n        boxShadow: '0 10px 25px -5px rgba(255, 149, 221, 0.3)',\n      },\n      vault: {\n        container: 'bg-gradient-to-r from-[#1A3A4A] to-[#30637C] border-[#A3E4DB] text-[#E5E6F0]',\n        header: 'text-[#E5E6F0] bg-black/40',\n        accent: '#A3E4DB', // Teal\n        secondaryColor: '#A3688F',\n        contentBg: 'bg-black/30 border-[#A3E4DB]/50',\n        filter: 'brightness-95 contrast-110',\n        icon: <Shield className=\"text-[#A3E4DB]\" size={18} />,\n        pattern: 'bg-[url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCI+PHBhdGggZD0iTTMwLDEwIEwxMCwzMCBMMzAsNTAgTDUwLDMwIFoiIHN0cm9rZT0iI0EzRTREQjIwIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiLz48L3N2Zz4=\")]',\n        boxShadow: '0 10px 25px -5px rgba(163, 228, 219, 0.3)',\n      }\n    };\n    return styles[design] || styles.heritage;\n  };\n\n  const getDesignIcon = (design) => {\n    const iconMap = {\n      'heritage': <Star className=\"text-[#FFD700]\" size={18} />,\n      'chronicle': <BookOpen className=\"text-[#64DFDF]\" size={18} />,\n      'legacy': <Heart className=\"text-[#FF95DD]\" size={18} />,\n      'vault': <Shield className=\"text-[#A3E4DB]\" size={18} />\n    };\n    return iconMap[design] || iconMap.heritage;\n  };\n\n  const getPrivacyIcon = (privacy) => {\n    switch(privacy) {\n      case 'private': return faLock;\n      case 'friends': return faUserGroup;\n      case 'public': return faGlobe;\n      default: return faGlobe;\n    }\n  };\n\n  const ThemeDecoration = ({ design }) => {\n    const styles = getDesignStyles(design);\n\n    return (\n        <div className=\"absolute inset-0 pointer-events-none overflow-hidden rounded-lg\">\n          <div className={`absolute inset-0 ${styles.pattern} opacity-30`} />\n\n          <div className=\"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent opacity-30 animate-pulse\" />\n\n          <div className=\"absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-white/40 to-transparent\" />\n          <div className=\"absolute inset-y-0 right-0 w-px bg-gradient-to-b from-transparent via-white/30 to-transparent\" />\n          <div className=\"absolute inset-x-0 bottom-0 h-px bg-gradient-to-r from-transparent via-white/40 to-transparent\" />\n          <div className=\"absolute inset-y-0 left-0 w-px bg-gradient-to-b from-transparent via-white/30 to-transparent\" />\n\n          <div className=\"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent\" />\n        </div>\n    );\n  };\n\n  const CapsuleCard = ({ capsule }) => {\n    const design = capsule.design || 'heritage';\n    const styles = getDesignStyles(design);\n    const isReady = capsule.daysLeft <= 0;\n    const images = JSON.parse(capsule.images || '[]');\n    const hasImages = images.length > 0;\n\n    return (\n        <div className={`relative rounded-lg border overflow-hidden mb-3 ${styles.contentBg}`}>\n          <ThemeDecoration design={design} />\n\n          <div className=\"flex justify-between items-center p-3\">\n            <div className=\"flex items-center space-x-2\">\n              {getDesignIcon(design)}\n              <p className=\"text-text font-medium truncate\">{capsule.title}</p>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <FontAwesomeIcon\n                  icon={getPrivacyIcon(capsule.privacy)}\n                  className=\"text-text/50\"\n                  title={`Privacy: ${capsule.privacy}`}\n              />\n              {isReady ? (\n                  <div className=\"flex items-center text-xs px-2 py-1 rounded-full bg-white/10 backdrop-blur-sm\">\n                    <Unlock size={12} style={{ color: styles.accent }} className=\"mr-1\" />\n                    <span style={{ color: styles.accent }}>Ready</span>\n                  </div>\n              ) : (\n                  <div className=\"flex items-center text-xs px-2 py-1 rounded-full bg-black/30\">\n                    <Lock size={12} style={{ color: styles.accent }} className=\"mr-1\" />\n                    <span>{`${capsule.daysLeft}d`}</span>\n                  </div>\n              )}\n            </div>\n          </div>\n\n          <div className=\"p-2 flex items-center\">\n            <div className=\"w-16 h-16 rounded overflow-hidden mr-3 relative bg-black/40\">\n              {hasImages ? (\n                  <>\n                    <img\n                        src=\"/api/placeholder/64/64\"\n                        alt=\"Memory preview\"\n                        className={`w-full h-full object-cover blur-sm ${styles.filter}`}\n                    />\n                    <div className=\"absolute inset-0 flex items-center justify-center\">\n                      <Camera size={16} style={{ color: styles.accent }} />\n                    </div>\n                  </>\n              ) : (\n                  <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <Package size={16} style={{ color: styles.accent }} />\n                  </div>\n              )}\n            </div>\n\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-text/60 text-xs line-clamp-2\">\n                {capsule.description || \"This memory is sealed until it's time to open it.\"}\n              </p>\n              <div className=\"mt-1 flex items-center text-text/50 text-xs\">\n                <Clock size={10} className=\"mr-1\" />\n                <span>\n                {new Date(capsule.created_at).toLocaleDateString(undefined, {\n                  year: 'numeric',\n                  month: 'short',\n                  day: 'numeric'\n                })}\n              </span>\n              </div>\n            </div>\n          </div>\n        </div>\n    );\n  };\n\n  return (\n      <div\n          className=\"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50\"\n          onClick={onClose}\n      >\n        <div\n            className=\"bg-background rounded-2xl max-w-md w-full overflow-hidden shadow-2xl border border-white/10\"\n            onClick={(e) => e.stopPropagation()}\n        >\n          <div className=\"relative overflow-hidden\">\n            <div className=\"absolute inset-0 bg-gradient-to-br from-[#3D2C40] to-[#5E3762]\">\n              <div className=\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIj48cGF0aCBkPSJNMjUsMjUgQzI1LDUwIDc1LDUwIDc1LDI1IiBzdHJva2U9IiNGRjk1REQyMCIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTI1LDc1IEMyNSw1MCA3NSw1MCA3NSw3NSIgc3Ryb2tlPSIjRkY5NUREMjAiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==')]\"></div>\n            </div>\n\n            <div className=\"relative p-6 backdrop-blur-sm\">\n              <div className=\"flex justify-between items-start\">\n                <div className=\"flex items-center\">\n                  <div className=\"relative\">\n                    <ImageWithFallback\n                        src={user.profile_image_url}\n                        alt={user.name}\n                        className=\"w-20 h-20 rounded-full object-cover border-4 border-[#FF95DD]\"\n                    />\n                    <div className=\"absolute inset-0 rounded-full shadow-inner\"></div>\n                  </div>\n                  <div className=\"ml-4\">\n                    <h2 className=\"text-white font-lexend font-bold text-2xl\">\n                      {user.name}\n                    </h2>\n\n                    {!isFriend && (\n                        <div className=\"text-white/70 mt-2 text-sm\">\n                          {isPending ? (\n                              <p className=\"flex items-center\">\n                                <FontAwesomeIcon icon={faUserGroup} className=\"opacity-70 mr-2\" />\n                                Friend request pending\n                              </p>\n                          ) : (\n                              <div className=\"flex items-center\">\n                                <span>Not friends yet</span>\n                                <button\n                                    onClick={onSendRequest}\n                                    className=\"ml-2 px-3 py-1 bg-[#FF95DD] text-white rounded-lg text-xs hover:bg-[#FF95DD]/90 transition\"\n                                >\n                                  Add Friend\n                                </button>\n                              </div>\n                          )}\n                        </div>\n                    )}\n                  </div>\n                </div>\n                <button\n                    onClick={onClose}\n                    className=\"text-white/50 hover:text-white transition-colors\"\n                >\n                  <FontAwesomeIcon icon={faTimes} size=\"lg\" />\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"p-6 max-h-96 overflow-y-auto\">\n            <div className=\"flex items-center mb-4\">\n              <FontAwesomeIcon icon={faCapsules} className=\"text-[#FF95DD] mr-2\" />\n              <h3 className=\"text-lg font-medium text-text/90\">\n                Memories {userCapsules.length > 0 ? `(${userCapsules.length})` : ''}\n              </h3>\n              {!isFriend && userCapsules.length > 0 &&\n                  <span className=\"ml-2 text-xs text-text/50\">(showing public only)</span>\n              }\n            </div>\n\n            {capsuleLoading ? (\n                <div className=\"space-y-4 mt-4\">\n                  {[1, 2, 3].map(i => (\n                      <div key={i} className=\"h-24 bg-white/5 rounded-lg animate-pulse\"></div>\n                  ))}\n                </div>\n            ) : error ? (\n                <div className=\"text-red-500 text-sm bg-red-500/10 p-4 rounded-lg\">\n                  {error}\n                </div>\n            ) : userCapsules.length > 0 ? (\n                <div className=\"space-y-1\">\n                  {userCapsules.map((capsule) => (\n                      <CapsuleCard key={capsule.id} capsule={capsule} />\n                  ))}\n                </div>\n            ) : (\n                <div className=\"text-center py-8 text-text/70\">\n                  <Package size={32} className=\"mx-auto mb-4 text-[#FF95DD] opacity-50\" />\n                  {isFriend ?\n                      'No memories created yet' :\n                      'No public memories available'\n                  }\n                </div>\n            )}\n          </div>\n        </div>\n      </div>\n  );\n});\n\n\nconst UserCard = memo(({\n  user,\n  onSelect,\n  onSendRequest,\n  isPending\n}) => {\n  const handleClick = useCallback(() => {\n    onSelect(user);\n  }, [user, onSelect]);\n\n  const handleSendRequest = useCallback((e) => {\n    e.stopPropagation();\n    if (!isPending && !user.friend_request_sent && !user.is_friend) {\n      onSendRequest(user.id);\n    }\n  }, [user, isPending, onSendRequest]);\n\n  return (\n    <div\n      className=\"bg-background/70 rounded-2xl p-4 sm:p-6 flex flex-col items-center shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer\"\n      onClick={handleClick}\n    >\n      <div className=\"relative w-20 h-20 sm:w-32 sm:h-32 mb-4\">\n        <ImageWithFallback\n          src={user.profile_image_url}\n          alt={user.name}\n          className=\"w-full h-full rounded-full object-cover border-4 border-[#FF95DD]\"\n        />\n      </div>\n      <h2 className=\"text-text font-lexend font-bold text-lg sm:text-xl mb-2\">{user.name}</h2>\n      <p className=\"text-text/70 font-lexend text-xs sm:text-sm mb-4 line-clamp-2\">\n        {user.bio || 'No bio available'}\n      </p>\n      {user.is_friend ? (\n        <span className=\"text-[#FF95DD] font-medium flex items-center gap-2\">\n          <FontAwesomeIcon icon={faUserFriends} />\n          Already Friends\n        </span>\n      ) : user.friend_request_sent ? (\n        <span className=\"text-[#FF95DD] font-medium flex items-center gap-2\">\n          <FontAwesomeIcon icon={faCheck} />\n          Request Sent\n        </span>\n      ) : (\n        <button\n          className={`bg-gradient-to-r from-[#FF95DD] to-[#FF5CAA] text-background font-lexend font-medium py-2 px-4 sm:px-6 rounded-full flex items-center hover:opacity-90 transition-opacity ${\n            isPending ? 'opacity-50 cursor-not-allowed' : ''\n          }`}\n          onClick={handleSendRequest}\n          disabled={isPending}\n        >\n          {isPending ? (\n            <span>Sending...</span>\n          ) : (\n            <>\n              <FontAwesomeIcon icon={faUserPlus} className=\"mr-2\" />\n              Connect\n            </>\n          )}\n        </button>\n      )}\n    </div>\n  );\n});\n\nconst SearchInput = memo(({ value, onChange }) => (\n  <div className=\"relative w-full max-w-sm mb-6 sm:mb-12\">\n    <input\n      type=\"text\"\n      placeholder=\"Search users...\"\n      className=\"w-full py-2 sm:py-3 px-4 sm:px-6 pr-10 rounded-full border-2 border-[#FF95DD] bg-background/50 text-text focus:outline-none focus:border-[#FF5CAA] transition-all duration-300\"\n      value={value}\n      onChange={onChange}\n    />\n    <FontAwesomeIcon\n      icon={faSearch}\n      className=\"absolute right-4 top-1/2 transform -translate-y-1/2 text-[#FF95DD]\"\n    />\n  </div>\n));\n\nconst Pagination = memo(({ currentPage, totalPages, onPageChange }) => {\n  return (\n    <div className=\"flex items-center justify-center gap-4 mt-8\">\n      <button\n        onClick={() => onPageChange(currentPage - 1)}\n        disabled={currentPage === 1}\n        className={`p-2 rounded-full ${\n          currentPage === 1 \n            ? 'text-text/30 cursor-not-allowed' \n            : 'text-[#FF95DD] hover:bg-[#FF95DD]/10'\n        }`}\n      >\n        <FontAwesomeIcon icon={faChevronLeft} />\n      </button>\n\n      <span className=\"font-lexend text-text\">\n        Page {currentPage} of {totalPages}\n      </span>\n\n      <button\n        onClick={() => onPageChange(currentPage + 1)}\n        disabled={currentPage === totalPages}\n        className={`p-2 rounded-full ${\n          currentPage === totalPages \n            ? 'text-text/30 cursor-not-allowed' \n            : 'text-[#FF95DD] hover:bg-[#FF95DD]/10'\n        }`}\n      >\n        <FontAwesomeIcon icon={faChevronRight} />\n      </button>\n    </div>\n  );\n});\n\nconst FriendsPage = () => {\n  const [allUsers, setAllUsers] = useState([]); // Store all users\n  const [users, setUsers] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [isInitialLoading, setIsInitialLoading] = useState(true);\n  const [pendingRequests, setPendingRequests] = useState(new Set());\n  const [error, setError] = useState(null);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [totalUsers, setTotalUsers] = useState(0);\n  const navigate = useNavigate();\n\n  const USERS_PER_PAGE = 9;\n\n  useEffect(() => {\n    const controller = new AbortController();\n    const fetchUsers = async () => {\n      const token = localStorage.getItem('access_token');\n      if (!token) {\n        navigate('/login');\n        return;\n      }\n\n      try {\n        const response = await fetch(\n            `https://istaisprojekts-main-lixsd6.laravel.cloud/api/friends`,\n            {\n              headers: {\n                'Authorization': `Bearer ${token}`,\n                'Accept': 'application/json',\n              },\n              signal: controller.signal\n            }\n        );\n\n        if (!response.ok) {\n          const errorData = await response.json();\n          throw new Error(errorData.message || 'Failed to fetch users');\n        }\n\n        const data = await response.json();\n\n        if (Array.isArray(data)) {\n          setAllUsers(data);\n          setTotalUsers(data.length);\n        } else if (data.users && Array.isArray(data.users)) {\n          setAllUsers(data.users);\n          setTotalUsers(data.total || data.users.length);\n        } else {\n          setAllUsers([]);\n          setTotalUsers(0);\n          console.error('Unexpected API response structure:', data);\n        }\n\n        setError(null);\n      } catch (error) {\n        if (error.name !== 'AbortError') {\n          console.error('Error fetching users:', error);\n          setError(error.message);\n          toast.error('Failed to load users: ' + error.message);\n          setAllUsers([]);\n          setTotalUsers(0);\n        }\n      } finally {\n        setIsInitialLoading(false);\n      }\n    };\n\n    fetchUsers();\n    return () => controller.abort();\n  }, [navigate]);\n\n  useEffect(() => {\n    if (!Array.isArray(allUsers)) return;\n\n    const searchLower = searchTerm.toLowerCase();\n    const filtered = searchTerm\n        ? allUsers.filter(user => user.name.toLowerCase().includes(searchLower))\n        : allUsers;\n\n    setTotalUsers(filtered.length);\n    setTotalPages(Math.ceil(filtered.length / USERS_PER_PAGE));\n\n    const startIndex = (currentPage - 1) * USERS_PER_PAGE;\n    const endIndex = startIndex + USERS_PER_PAGE;\n    setUsers(filtered.slice(startIndex, endIndex));\n\n    if (currentPage > Math.ceil(filtered.length / USERS_PER_PAGE)) {\n      setCurrentPage(1);\n    }\n  }, [allUsers, searchTerm, currentPage, USERS_PER_PAGE]);\n\n  const filteredUsers = useMemo(() => {\n    const filledArray = [...users];\n    while (filledArray.length < USERS_PER_PAGE) {\n      filledArray.push(null);\n    }\n    return filledArray;\n  }, [users]);\n\n  const handleSearch = useCallback((e) => {\n    setSearchTerm(e.target.value);\n    setCurrentPage(1);\n  }, []);\n\n  const handlePageChange = useCallback((newPage) => {\n    setCurrentPage(newPage);\n  }, []);\n\n  const handleSendRequest = useCallback(async (targetUserId) => {\n    setPendingRequests(prev => new Set(prev).add(targetUserId));\n\n    const token = localStorage.getItem('access_token');\n    if (!token) {\n      navigate('/login');\n      return;\n    }\n\n    try {\n      const response = await fetch('https://istaisprojekts-main-lixsd6.laravel.cloud/api/friends/request', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Accept': 'application/json',\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          target_user_id: targetUserId,\n        }),\n      });\n\n      if (!response.ok) throw new Error('Failed to send friend request');\n\n      toast.success('Friend request sent');\n\n      setAllUsers(prev =>\n          prev.map(user =>\n              user?.id === targetUserId\n                  ? { ...user, friend_request_sent: true }\n                  : user\n          )\n      );\n\n      setUsers(prev =>\n          prev.map(user =>\n              user?.id === targetUserId\n                  ? { ...user, friend_request_sent: true }\n                  : user\n          )\n      );\n    } catch (error) {\n      console.error('Error sending friend request:', error);\n      toast.error('Failed to send friend request');\n    } finally {\n      setPendingRequests(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(targetUserId);\n        return newSet;\n      });\n    }\n  }, [navigate]);\n\n  const handleUserSelect = useCallback((user) => {\n    if (user) setSelectedUser(user);\n  }, []);\n\n  const handleCloseModal = useCallback(() => {\n    setSelectedUser(null);\n  }, []);\n\n  const EmptyCard = memo(() => (\n    <div className=\"bg-background/70 rounded-2xl p-4 sm:p-6 flex flex-col items-center shadow-lg h-full\">\n      <div className=\"w-20 h-20 sm:w-32 sm:h-32 mb-4 bg-gray-200 rounded-full animate-pulse\" />\n      <div className=\"h-6 w-32 bg-gray-200 rounded mb-2 animate-pulse\" />\n      <div className=\"h-4 w-48 bg-gray-200 rounded mb-4 animate-pulse\" />\n      <div className=\"h-8 w-24 bg-gray-200 rounded-full animate-pulse\" />\n    </div>\n  ));\n  return (\n      <div className=\"min-h-screen flex flex-col items-center bg-background px-4 sm:px-8 py-12\">\n        <h1 className=\"text-text font-lexend font-bold text-2xl sm:text-4xl mb-6 sm:mb-12\">\n          Find Friends\n        </h1>\n\n        <SearchInput value={searchTerm} onChange={handleSearch} />\n\n        <Suspense fallback={<div>Loading...</div>}>\n          {isInitialLoading ? (\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 w-full\">\n                {Array(USERS_PER_PAGE).fill(null).map((_, index) => (\n                    <EmptyCard key={`loading-${index}`} />\n                ))}\n              </div>\n          ) : error ? (\n              <div className=\"text-red-500\">{error}</div>\n          ) : totalUsers === 0 ? (\n              <div className=\"text-text/70\">No users found</div>\n          ) : (\n              <>\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 w-full\">\n                  {filteredUsers.map((user, index) => (\n                      user ? (\n                          <UserCard\n                              key={user.id}\n                              user={user}\n                              onSelect={handleUserSelect}\n                              onSendRequest={handleSendRequest}\n                              isPending={pendingRequests.has(user.id)}\n                          />\n                      ) : (\n                          <EmptyCard key={`empty-${index}`} />\n                      )\n                  ))}\n                </div>\n\n                {totalPages > 1 && (\n                    <Pagination\n                        currentPage={currentPage}\n                        totalPages={totalPages}\n                        onPageChange={handlePageChange}\n                    />\n                )}\n              </>\n          )}\n        </Suspense>\n        {selectedUser && (\n            <UserModal\n                user={selectedUser}\n                onClose={handleCloseModal}\n                onSendRequest={handleSendRequest}\n                isPending={pendingRequests.has(selectedUser.id)}\n            />\n        )}\n      </div>\n  );\n};\n\n\nexport default FriendsPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}